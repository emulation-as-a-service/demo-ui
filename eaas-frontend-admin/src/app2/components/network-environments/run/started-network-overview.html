<h2 class="m-t-0">Network Environment Overview</h2>



<div *ngIf="eaasClient.network">
    <network-config-template
        [networkingConfig]="networkingConfig"
        [isDisabled]="true"
    ></network-config-template>
    <br>
    <div class="tekst">
     <button style="display: inline" (click)="openConsolidatedNetworkView()" mat-raised-button>Consolidated View</button>
    </div>

    <!--    Network environments action table (connect, delete environments)   -->
    <h4 class="m-t-0">Connected Environments</h4>
    <table mat-table [dataSource]="networkSessionEnvironments" multiTemplateDataRows class="mat-elevation-z8">

    <ng-container matColumnDef="environment">
        <th mat-header-cell *matHeaderCellDef>Environment</th>
        <td mat-cell *matCellDef="let element"> {{element.title}} </td>
    </ng-container>

    <ng-container matColumnDef="label">
        <th mat-header-cell *matHeaderCellDef>Label</th>
        <td mat-cell *matCellDef="let element"> {{element.label}} </td>
    </ng-container>

    <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef> Action </th>
        <td mat-cell *matCellDef="let element">
            <button (click)="connect(element)" [disabled]="eaasClient.activeView && eaasClient.activeView.componentId===element.componentId" style="margin-right:5px;" mat-raised-button >
                {{eaasClient.activeView && eaasClient.activeView.componentId===element.componentId ? "active" : "view"}}
            </button>
            <button *ngIf="eaasClient.activeView && eaasClient.activeView.componentId!==element.componentId" (click)="delete(element)" mat-raised-button color="warn">delete</button>
        </td>
    </ng-container>

    <ng-container matColumnDef="expandedDetail">
        <td mat-cell  *matCellDef="let element" [attr.colspan]="displayedColumns.length">
            <div class="example-element-detail"
                 [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                <div class="example-element-description">
                    <div *ngIf="!element.networkData.serverIp"><b>Network is not defined</b></div>
                    <div class="tekst" *ngIf="element.networkData.serverIp">
                            <div class="block_container">
                                <div class="bloc1">ServerIp: </div>
                                <div class="bloc2">{{element.networkData.serverIp}}</div>
                            </div>
                            <br>
                        <div *ngFor="let port of element.networkData.serverPorts">
                            <form name="localPort-binding-form"
                                  (ngSubmit)="bindLocalPort(f, element.networkData.serverIp, port)" #f="ngForm"
                                  class="tekst">
                                <div class="block_container">
                                    <div class="bloc1">{{'EDITENV_SERVER_PORT' | translate}}: </div>
                                    <div class="bloc2">{{port}}</div>
                                </div>
                                <mat-form-field>
                                    <!-- Allow only valid ports -->
                                    <input ngModel name="localPortBinding" required
                                           pattern="^()([1-9]|[1-5]?[0-9]{2,4}|6[1-4][0-9]{3}|65[1-4][0-9]{2}|655[1-2][0-9]|6553[1-5])$"
                                           matInput type="number"
                                           placeholder="Local Port">
                                    <mat-error>Entered port is invalid!</mat-error>
                                </mat-form-field>
                                <button type="submit" value="submit" style="margin-left: 2px" mat-raised-button>
                                    {{"SYNC_SET_URI_BTN"|translate}}
                                    <mat-icon>leak_add</mat-icon>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let element; columns: displayedColumns;"
        class="example-element-row"
        [class.example-expanded-row]="expandedElement && expandedElement.componentId === element.componentId"
        (click)="expandedElement = expandedElement && expandedElement.componentId === element.componentId ? null : element">
    </tr>
    <tr mat-row *matRowDef="let row; columns: ['expandedDetail'];"
        class="example-detail-row"
        [ngClass]="expandedElement && expandedElement.componentId === row.componentId ? 'example-element-row': 'hidden-column'"
    ></tr>

</table>
    <iframe id="eaas-proxy-iframe" name="eaas-proxy" hidden sandbox></iframe>
</div>
