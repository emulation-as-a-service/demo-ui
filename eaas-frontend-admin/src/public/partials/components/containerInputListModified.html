<div class="panel panel-default">

    <div class="panel-heading">{{$ctrl.heading}}</div>
    <div class="panel-body">

        <!-- List of added inputs -->
        <ul class="list-group">
            <li class="list-group-item" ng-repeat="elem in $ctrl.list track by $index">
                <label>Input source</label>
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="$ctrl.list[$index].url" size="30">
                    <span class="input-group-addon">Url</span>
                </div>
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="$ctrl.list[$index].name" size="30">
                    <span class="input-group-addon">Destination</span>

                </div>
                <div class="input-group">
                <label>Action:</label> {{$ctrl.list[$index].action}}
                </div>
                <div class="input-group">
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="$ctrl.list.splice($index, 1)">
                            Delete input
                        </button>
                    </span>
                </div>
            </li>
        </ul>

        <!-- Choose input source dropdown menu -->
        <div class="dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
            {{$ctrl.inputSourceButtonText}}<span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li><a ng-click="$ctrl.onInputSourceSelection($event)" method="upload">Upload Files</a></li>
                <li><a ng-click="$ctrl.onInputSourceSelection($event)" method="import">Import from URL</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">REST Interfaces</li>
                <li><a ng-click="$ctrl.onInputSourceSelection($event)" method="uniprot">Uniprot</a></li>
                <li><a ng-click="$ctrl.onInputSourceSelection($event)" method="pride">PRIDE Archive</a></li>
            </ul>
        </div>

        <!-- Appropriate section for each input source -->
        <!-- Upload Files -->
        <div ng-if="$ctrl.showDialogs['upload']" >
            <button type="button" class="btn btn-default" ngf-select="$ctrl.onImportFilesChosen($files)" multiple >Select Files</button>
            <li class="list-group-item" ng-repeat="elem in $ctrl.uploadFiles track by $index">
                <!-- Display uploaded files together with their upload status, and choose destination in Container -->
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="$ctrl.uploadFiles[$index].filename" size="30">
                    <span class="input-group-addon">Chosen File</span>
                </div>
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="$ctrl.uploadFiles[$index].destination" size="30">
                    <span class="input-group-addon">Destination</span>
                </div>
                <div class="input-group">
                    <select class="form-control" theme="bootstrap" ng-model="$ctrl.uploadFiles[$index].action">
                        <option value="copy">copy</option>
                        <option value="extract">extract</option>
                    </select>
                    <span class="input-group-addon">Action</span>
                </div>
                <span class="progress" ng-show="progress >= 0">
                    <div style="width:{{progress}}%" ng-bind="progress + '%'"></div>
                </span>
            </li>
            <button ng-show="$ctrl.uploadFiles.length > 0" type="button" class="btn btn-default" ng-click="$ctrl.onFileUpload()" >Upload and Add files</button>
        </div>
        <!-- Import from URL -->
        <div ng-if="$ctrl.showDialogs['import']" >
            <div class="input-group">
                <input type="text" class="form-control" placeholder="{{$ctrl.inputPlaceholder}}" ng-model="$ctrl.newInputUrl" size="30">
                <span class="input-group-addon">Url</span>
            </div>
            <div class="input-group">
                <input type="text" class="form-control" placeholder="{{$ctrl.inputPlaceholder}}" ng-model="$ctrl.newInputName" size="30">
                <span class="input-group-addon">Destination</span>
            </div>
            <div class="input-group">
                <select class="form-control" theme="bootstrap" ng-model="$ctrl.newAction" >
                    <option value="copy">copy</option>
                    <option value="extract">extract</option>
                </select>
                <span class="input-group-addon">Action</span>
            </div>
            <div class="input-group">
                <span class="input-group-btn">
                     <button class="btn btn-default" type="button"
                             ng-click="$ctrl.list.push({url : $ctrl.newInputUrl, name : $ctrl.newInputName , action : $ctrl.newAction});
                             $ctrl.newInputUrl =''; $ctrl.newInputName=''; $ctrl.newAction =''">
                         {{$ctrl.addButtonText}}
                     </button>
                 </span>
            </div>
        </div>

        <!-- Uniprot -->
        <div ng-if="$ctrl.showDialogs['uniprot']" >
            <div><input type="radio" name="uniprotMode" ng-model="uniprotMode" value="individual" ng-change="string"> Retrieving individual entries</div>
            <div><input type="radio" name="uniprotMode" ng-model="uniprotMode" value="batch" ng-change="string"> Batch retrieval of entries</div>
            <div><input type="radio" name="uniprotMode" ng-model="uniprotMode" value="query" ng-change="string"> Retrieve entries via queries</div>
            
            <!-- Uniprot individual entries -->
            <div ng-if="uniprotMode == 'individual'">
                <div class="input-group">
                    <textarea class="scrollabletextbox" id="uniprotUrls" placeholder="Newline separated URLs, e.g.
https://www.uniprot.org/uniprot/P12345.txt
https://www.uniprot.org/uniprot/P12345.xml
https://www.uniprot.org/uniprot/P12345.rdf" rows="5" style="width:100%;overflow:auto;resize:none" ng-model="$ctrl.uniprotUrls"></textarea>
                    <span class="input-group-addon">Filename(s)</span>
                </div>
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="{{$ctrl.inputPlaceholder}}" ng-model="$ctrl.newInputName" style="width:100%">
                    <span class="input-group-addon">Destination Prefix</span>
                </div>
                <div class="input-group">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button"
                                 ng-click="$ctrl.onUniprotUrls()">
                                {{$ctrl.addButtonText}}
                        </button>
                    </span>
                </div>
            </div>
            <!-- Uniprot batch retrieval -->
            <div ng-if="uniprotMode == 'batch'">
                <button type="button" class="btn btn-default" ngf-select="$ctrl.onUniprotBatchFileChosen($files)">Choose Batch File</button>
                <div class="input-group">
                    <input type="text" class="form-control" id="inputFileName" ng-readonly=true ng-model="$ctrl.uniprotBatch.name" size="30">
                    <span class="input-group-addon">Batch File</span>
                </div>
                <div class="input-group">
                    <input type="text" class="form-control" id="containerFileName" placeholder="{{$ctrl.inputPlaceholder}}" ng-model="$ctrl.newInputName" size="30">
                    <span class="input-group-addon">Destination</span>
                </div>
                <div class="input-group">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button" ng-click="$ctrl.onUniprotBatch()">
                                 Retrieve Batch
                        </button>
                    </span>
                </div>
            </div>
            <!-- Uniprot queries -->
            <div ng-if="uniprotMode == 'query'">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="(e.g. organism:human AND antigen&format=fasta&compress=yes)" ng-model="$ctrl.uniprotQuery" title="If no format is chosen, format=fasta will be added" size="30">
                    <span class="input-group-addon">Query</span>
                </div>
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="{{$ctrl.inputPlaceholder}}" ng-model="$ctrl.newInputName" title="Filename or directory relative to the containers input directory" size="30">
                    <span class="input-group-addon">Destination</span>
                </div>
                <div class="input-group">
                    <select class="form-control" theme="bootstrap" ng-model="$ctrl.newAction" >
                        <option value="copy">copy</option>
                        <option value="extract">extract</option>
                    </select>
                    <span class="input-group-addon">Action</span>
                </div>
                <div class="input-group">
                    <span class="input-group-btn">
                         <button class="btn btn-default" type="button" ng-click="$ctrl.onUniprotQuery()">
                            {{$ctrl.addButtonText}}
                        </button>
                    </span>
                </div>
            </div>
        </div>
        <!-- PRIDE Archive -->
        <div ng-if="$ctrl.showDialogs['pride']">
            </br>
            Enter Project Accession:
            <div class="input-group">
                <input type="text" class="form-control" placeholder="e.g. PXD007621" ng-model="$ctrl.prideAccession" size="30">
                    <span class="input-group-addon">Accession</span>
            </div>
            </br>
            <div class="input-group">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" ng-click="$ctrl.onPrideListFiles()">
                        List Files 
                    </button>
                </span>
            </div>

            <div>
                </br>
                <div ng-repeat="(fileType, files) in $ctrl.prideFiles">
                    <input type="checkbox" ng-model="$ctrl.prideFiles[fileType].checked" ng-click="$ctrl.onPrideMasterCheckbox($event)" data="{{fileType}}"><label> {{files.list.length}} {{fileType}} Files</label>
                    <div style="padding:0px 20px 0px 20px;" ng-repeat="elem in files.list track by $index">
                        <input type="checkbox" ng-model="$ctrl.prideFiles[fileType].list[$index].checked"> {{elem.fileName}}
                    </div>
                    </br>
                </div>
                <div class="input-group">
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="button" ng-click="$ctrl.onPrideAddFiles()">
                            Add Files
                        </button>
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>
